This folder contains all MATLAB code to combine 3D-AFM measurements above multiple AqpZ surface. Only run the main code and the main code must be run section by section!

## Main codes:
1. volume_construction_essemble_v3_AqpZ.m
	Merge the drift-corrected energy data above multiple AqpZ into one single dataset, and apply a kernel generated by the helper function to connect the isolated points into a surface.
2. force_calculation_v1.m
	Use numerical differential to calculate the force from energy matrix.
3. force_adjustment_v1.m
	Restore the values of the matrix to real value since the kernel application step actually decrease the value by spreading the value of the point to the volume of the kernel.


## Helper function.
1. make_3D_LAFM_kernel1a.m
	Generate a kernel to be used in the main code 1.


## Instructions.
1. Run "volume_construction_essemble_v3_AqpZ.m" first, it needs the input of the structure data set from pre-processing. The parameters of the first section is the default used in the main text.
2. The result of "volume_construction_essemble_v3_AqpZ.m" will be saved at the end of the script, the filename of which needs to be input into "force_calculation_v1.m" for the continue processing.
3. Lastly, run "force_adjustment_v1.m", no extra input is needed. "ppvolumeF3" will be the final result of 3D-AFM averaged data.


## Raw data:
The calculation result from this section is uploaded to: https://doi.org/10.5281/zenodo.15866205, as dataset 3.2. The ppvolumeF3 is the original data that is plotted in Figure 3.